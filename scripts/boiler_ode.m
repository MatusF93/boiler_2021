function dxdt = boiler_ode(t,x,u)

% Static parameters 
l   = @(rb) -0.000016739*rb^2 + 0.00294744*rb + 0.973044;
k11 = @(rb) -0.10233*rb^2 - 30.144*rb + 16277;
k12 = @(rb) 0.07672*rb^2 - 12.66*rb + 2225.945;
k13 = @(rb) -0.2143*rb^2 + 43.31*rb - 338.57;
k2  = @(rb) -1.5422e-5*rb^2 + 4.093e-3*rb + 0.33177;

% Dynamic parameters
tau = 12;
c0  = 152;
c11 = 110475;
c12 = 197128;
d11 = 103;
d12 = 2004;
c2  = 89912;
c31 = 2667932;
c32 = 44805;
d21 = 236;
d22 = 3001;
c4  = 10;

% Functions
g   = @(pm) 0.08*pm^1.2474; % not in article
g1  = @(pm) 0.01784*pm^2  - 0.8*pm   + 10.0919;
g2  = @(pm) -0.04112*pm^2 + 1.867*pm - 15.018;
f1  = @(pst,hst) (91611*pst)/(0.76*hst - 592.95);
f2  = @(p5,h5)  (889857*p5)/(6.29*h5 + 2862.86);
hfw = @(rb) 471.67*rb^(0.215);
hsw1= @(rb) 522.57*rb^(0.193);
hsw2= @(rb) 522.57*rb^(0.193);

% Nonlinear Model
h5 = l(x(1))* x(3);
p5 = x(2) - g1(x(2));
p3 = x(2) - g2(x(2));
D5 = f1(p5,h5)*u(3);
D4 = D5 + u(4);
D3 = D4;
D2 = D3 + u(5);
h4 = (D5*h5 + u(4)*hsw1(x(1)))/D4;
h2 = (D3*x(4) + u(5)*hsw2(x(1)))/D2;


% Model
dxdt(1,:) = u(1)/c0 - x(1)/c0; % without (t-tau)
dxdt(2,:) = ((hfw(x(1)) - d11)/c11)*(u(2) - u(4) - u(5)) + ((d11 - h5)/c11) * f1(x(2)-g(x(2)), h5) * u(3) + k11(x(1))*x(1)/c11;
dxdt(3,:) = ((hfw(x(1)) - d12)/c12)*(u(2) - u(4) - u(5)) + ((d12 - h5)/c12) * f1(x(2)-g(x(2)), h5) * u(3) + k11(x(1))*x(1)/c12;
dxdt(4,:) = (D3*(h4 - x(4)))/c2 + k12(x(1))*x(1)/c2;
dxdt(5,:) = ((h2 - d21)/c32)*D2 + ((d21 - x(6))/c31) * f2(x(5), x(6)) * u(3) + k13(x(1))*x(1)/c31;
dxdt(6,:) = ((h2 - d22)/c32)*D2 + ((d22 - x(6))/c32) * f2(x(5), x(6)) * u(3) + k13(x(1))*x(1)/c32;
dxdt(7,:) = -x(7)/c4 + (k2(x(1))*(x(6) - hfw(x(1))) * f2(x(5), x(6)) * u(3))/c4;
end